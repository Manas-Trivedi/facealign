============================================================
GENDER CLASSIFICATION TRAINING
============================================================
Using device: mps

Loading data from: data/facecom/Task_A
TRAIN Dataset loaded:
  Male: 1532
  Female: 850
  Total: 2382
VAL Dataset loaded:
  Male: 317
  Female: 105
  Total: 422

Dataloaders created:
Train batches: 149
Val batches: 27
Class weights: tensor([0.7774, 1.4012])

Creating model...
Total parameters: 21,285,698
Trainable parameters: 21,285,698

Setting up training...
Class weights: tensor([0.7774, 1.4012])

Training Configuration:
Epochs: 25
Batch Size: 16
Learning Rate: 0.0001
Early Stopping Patience: 7
Scheduler: ReduceLROnPlateau (patience=3)

Starting training at 2025-06-20 23:29:08
============================================================

Epoch 1 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.4948
Batch [40/149] - Loss: 11.0492
Batch [60/149] - Loss: 0.0000
Batch [80/149] - Loss: 0.0172
Batch [100/149] - Loss: 3.8277
Batch [120/149] - Loss: 0.9193
Batch [140/149] - Loss: 6.7512

Train Results:
Loss: 3.3153 | Accuracy: 0.8904
Precision: 0.8927 | Recall: 0.8904 | F1: 0.8911
Female (Class 1) - Precision: 0.8261, Recall: 0.8776, F1: 0.8511

Epoch 1 - Validation:
--------------------------------------------------

Validation Results:
Loss: 1.1858 | Accuracy: 0.9336
Precision: 0.9387 | Recall: 0.9336 | F1: 0.9350
Female (Class 1) - Precision: 0.8235, Recall: 0.9333, F1: 0.8750

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.98      0.93      0.95       317
      Female       0.82      0.93      0.88       105

    accuracy                           0.93       422
   macro avg       0.90      0.93      0.91       422
weighted avg       0.94      0.93      0.93       422


============================================================
EPOCH 1/25 SUMMARY
Time: 86.84s | LR: 0.000100
Train - Loss: 3.3153, Acc: 0.8904, F1: 0.8911
Val   - Loss: 1.1858, Acc: 0.9336, F1: 0.9350
✅ New best accuracy: 0.9336 - Model saved!
============================================================

Epoch 2 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.3903
Batch [40/149] - Loss: 0.5791
Batch [60/149] - Loss: 0.0000
Batch [80/149] - Loss: 1.8801
Batch [100/149] - Loss: 0.2235
Batch [120/149] - Loss: 0.0058
Batch [140/149] - Loss: 2.6614

Train Results:
Loss: 1.0377 | Accuracy: 0.9429
Precision: 0.9444 | Recall: 0.9429 | F1: 0.9432
Female (Class 1) - Precision: 0.8976, Recall: 0.9482, F1: 0.9222

Epoch 2 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.8619 | Accuracy: 0.9408
Precision: 0.9401 | Recall: 0.9408 | F1: 0.9403
Female (Class 1) - Precision: 0.9000, Recall: 0.8571, F1: 0.8780

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.95      0.97      0.96       317
      Female       0.90      0.86      0.88       105

    accuracy                           0.94       422
   macro avg       0.93      0.91      0.92       422
weighted avg       0.94      0.94      0.94       422


============================================================
EPOCH 2/25 SUMMARY
Time: 87.74s | LR: 0.000100
Train - Loss: 1.0377, Acc: 0.9429, F1: 0.9432
Val   - Loss: 0.8619, Acc: 0.9408, F1: 0.9403
✅ New best accuracy: 0.9408 - Model saved!
============================================================

Epoch 3 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.0000
Batch [40/149] - Loss: 0.4405
Batch [60/149] - Loss: 0.0000
Batch [80/149] - Loss: 0.6159
Batch [100/149] - Loss: 0.0000
Batch [120/149] - Loss: 0.0000
Batch [140/149] - Loss: 0.0000

Train Results:
Loss: 0.4541 | Accuracy: 0.9702
Precision: 0.9703 | Recall: 0.9702 | F1: 0.9702
Female (Class 1) - Precision: 0.9534, Recall: 0.9635, F1: 0.9585

Epoch 3 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.7713 | Accuracy: 0.9526
Precision: 0.9523 | Recall: 0.9526 | F1: 0.9520
Female (Class 1) - Precision: 0.9381, Recall: 0.8667, F1: 0.9010

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.96      0.98      0.97       317
      Female       0.94      0.87      0.90       105

    accuracy                           0.95       422
   macro avg       0.95      0.92      0.93       422
weighted avg       0.95      0.95      0.95       422


============================================================
EPOCH 3/25 SUMMARY
Time: 88.07s | LR: 0.000100
Train - Loss: 0.4541, Acc: 0.9702, F1: 0.9702
Val   - Loss: 0.7713, Acc: 0.9526, F1: 0.9520
✅ New best accuracy: 0.9526 - Model saved!
============================================================

Epoch 4 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.2606
Batch [40/149] - Loss: 0.0000
Batch [60/149] - Loss: 0.0000
Batch [80/149] - Loss: 0.0045
Batch [100/149] - Loss: 0.0090
Batch [120/149] - Loss: 0.0000
Batch [140/149] - Loss: 0.0000

Train Results:
Loss: 0.2948 | Accuracy: 0.9769
Precision: 0.9770 | Recall: 0.9769 | F1: 0.9769
Female (Class 1) - Precision: 0.9606, Recall: 0.9753, F1: 0.9679

Epoch 4 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.4230 | Accuracy: 0.9526
Precision: 0.9530 | Recall: 0.9526 | F1: 0.9528
Female (Class 1) - Precision: 0.8972, Recall: 0.9143, F1: 0.9057

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.97      0.97      0.97       317
      Female       0.90      0.91      0.91       105

    accuracy                           0.95       422
   macro avg       0.93      0.94      0.94       422
weighted avg       0.95      0.95      0.95       422


============================================================
EPOCH 4/25 SUMMARY
Time: 67.33s | LR: 0.000100
Train - Loss: 0.2948, Acc: 0.9769, F1: 0.9769
Val   - Loss: 0.4230, Acc: 0.9526, F1: 0.9528
❌ No improvement. Patience: 1/7
============================================================

Epoch 5 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.0000
Batch [40/149] - Loss: 0.0000
Batch [60/149] - Loss: 0.0090
Batch [80/149] - Loss: 0.0000
Batch [100/149] - Loss: 0.0000
Batch [120/149] - Loss: 0.0000
Batch [140/149] - Loss: 1.3626

Train Results:
Loss: 0.1214 | Accuracy: 0.9882
Precision: 0.9883 | Recall: 0.9882 | F1: 0.9883
Female (Class 1) - Precision: 0.9790, Recall: 0.9882, F1: 0.9836

Epoch 5 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.4007 | Accuracy: 0.9645
Precision: 0.9642 | Recall: 0.9645 | F1: 0.9643
Female (Class 1) - Precision: 0.9412, Recall: 0.9143, F1: 0.9275

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.97      0.98      0.98       317
      Female       0.94      0.91      0.93       105

    accuracy                           0.96       422
   macro avg       0.96      0.95      0.95       422
weighted avg       0.96      0.96      0.96       422


============================================================
EPOCH 5/25 SUMMARY
Time: 54.53s | LR: 0.000100
Train - Loss: 0.1214, Acc: 0.9882, F1: 0.9883
Val   - Loss: 0.4007, Acc: 0.9645, F1: 0.9643
✅ New best accuracy: 0.9645 - Model saved!
============================================================

Epoch 6 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.0000
Batch [40/149] - Loss: 0.4301
Batch [60/149] - Loss: 0.3683
Batch [80/149] - Loss: 0.0000
Batch [100/149] - Loss: 0.0002
Batch [120/149] - Loss: 0.0001
Batch [140/149] - Loss: 0.0000

Train Results:
Loss: 0.1773 | Accuracy: 0.9828
Precision: 0.9829 | Recall: 0.9828 | F1: 0.9828
Female (Class 1) - Precision: 0.9709, Recall: 0.9812, F1: 0.9760

Epoch 6 - Validation:
--------------------------------------------------

Validation Results:
Loss: 1.2565 | Accuracy: 0.9431
Precision: 0.9432 | Recall: 0.9431 | F1: 0.9417
Female (Class 1) - Precision: 0.9451, Recall: 0.8190, F1: 0.8776

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.94      0.98      0.96       317
      Female       0.95      0.82      0.88       105

    accuracy                           0.94       422
   macro avg       0.94      0.90      0.92       422
weighted avg       0.94      0.94      0.94       422


============================================================
EPOCH 6/25 SUMMARY
Time: 54.69s | LR: 0.000100
Train - Loss: 0.1773, Acc: 0.9828, F1: 0.9828
Val   - Loss: 1.2565, Acc: 0.9431, F1: 0.9417
❌ No improvement. Patience: 1/7
============================================================

Epoch 7 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.0005
Batch [40/149] - Loss: 0.0000
Batch [60/149] - Loss: 0.0000
Batch [80/149] - Loss: 3.2136
Batch [100/149] - Loss: 0.0009
Batch [120/149] - Loss: 0.0000
Batch [140/149] - Loss: 0.0000

Train Results:
Loss: 0.1694 | Accuracy: 0.9857
Precision: 0.9858 | Recall: 0.9857 | F1: 0.9857
Female (Class 1) - Precision: 0.9744, Recall: 0.9859, F1: 0.9801

Epoch 7 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.6560 | Accuracy: 0.9336
Precision: 0.9398 | Recall: 0.9336 | F1: 0.9351
Female (Class 1) - Precision: 0.8182, Recall: 0.9429, F1: 0.8761

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.98      0.93      0.95       317
      Female       0.82      0.94      0.88       105

    accuracy                           0.93       422
   macro avg       0.90      0.94      0.92       422
weighted avg       0.94      0.93      0.94       422


============================================================
EPOCH 7/25 SUMMARY
Time: 55.34s | LR: 0.000100
Train - Loss: 0.1694, Acc: 0.9857, F1: 0.9857
Val   - Loss: 0.6560, Acc: 0.9336, F1: 0.9351
❌ No improvement. Patience: 2/7
============================================================

Epoch 8 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.0008
Batch [40/149] - Loss: 0.0000
Batch [60/149] - Loss: 0.0000
Batch [80/149] - Loss: 0.0000
Batch [100/149] - Loss: 0.0000
Batch [120/149] - Loss: 0.3131
Batch [140/149] - Loss: 0.0000

Train Results:
Loss: 0.1546 | Accuracy: 0.9832
Precision: 0.9833 | Recall: 0.9832 | F1: 0.9832
Female (Class 1) - Precision: 0.9720, Recall: 0.9812, F1: 0.9766

Epoch 8 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.5532 | Accuracy: 0.9692
Precision: 0.9700 | Recall: 0.9692 | F1: 0.9694
Female (Class 1) - Precision: 0.9182, Recall: 0.9619, F1: 0.9395

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.99      0.97      0.98       317
      Female       0.92      0.96      0.94       105

    accuracy                           0.97       422
   macro avg       0.95      0.97      0.96       422
weighted avg       0.97      0.97      0.97       422


============================================================
EPOCH 8/25 SUMMARY
Time: 55.63s | LR: 0.000100
Train - Loss: 0.1546, Acc: 0.9832, F1: 0.9832
Val   - Loss: 0.5532, Acc: 0.9692, F1: 0.9694
✅ New best accuracy: 0.9692 - Model saved!
============================================================

Epoch 9 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.0000
Batch [40/149] - Loss: 0.0000
Batch [60/149] - Loss: 0.0000
Batch [80/149] - Loss: 0.0000
Batch [100/149] - Loss: 0.0000
Batch [120/149] - Loss: 0.0000
Batch [140/149] - Loss: 0.0000

Train Results:
Loss: 0.1460 | Accuracy: 0.9840
Precision: 0.9841 | Recall: 0.9840 | F1: 0.9841
Female (Class 1) - Precision: 0.9743, Recall: 0.9812, F1: 0.9777

Epoch 9 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.6044 | Accuracy: 0.9502
Precision: 0.9516 | Recall: 0.9502 | F1: 0.9487
Female (Class 1) - Precision: 0.9773, Recall: 0.8190, F1: 0.8912

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.94      0.99      0.97       317
      Female       0.98      0.82      0.89       105

    accuracy                           0.95       422
   macro avg       0.96      0.91      0.93       422
weighted avg       0.95      0.95      0.95       422


============================================================
EPOCH 9/25 SUMMARY
Time: 55.23s | LR: 0.000100
Train - Loss: 0.1460, Acc: 0.9840, F1: 0.9841
Val   - Loss: 0.6044, Acc: 0.9502, F1: 0.9487
❌ No improvement. Patience: 1/7
============================================================

Epoch 10 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.0000
Batch [40/149] - Loss: 0.0000
Batch [60/149] - Loss: 0.0000
Batch [80/149] - Loss: 0.0000
Batch [100/149] - Loss: 0.0000
Batch [120/149] - Loss: 1.2598
Batch [140/149] - Loss: 0.0000

Train Results:
Loss: 0.1312 | Accuracy: 0.9887
Precision: 0.9887 | Recall: 0.9887 | F1: 0.9887
Female (Class 1) - Precision: 0.9813, Recall: 0.9871, F1: 0.9842

Epoch 10 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.3726 | Accuracy: 0.9573
Precision: 0.9571 | Recall: 0.9573 | F1: 0.9572
Female (Class 1) - Precision: 0.9223, Recall: 0.9048, F1: 0.9135

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.97      0.97      0.97       317
      Female       0.92      0.90      0.91       105

    accuracy                           0.96       422
   macro avg       0.95      0.94      0.94       422
weighted avg       0.96      0.96      0.96       422


============================================================
EPOCH 10/25 SUMMARY
Time: 55.98s | LR: 0.000100
Train - Loss: 0.1312, Acc: 0.9887, F1: 0.9887
Val   - Loss: 0.3726, Acc: 0.9573, F1: 0.9572
❌ No improvement. Patience: 2/7
============================================================

Epoch 11 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.0000
Batch [40/149] - Loss: 0.0000
Batch [60/149] - Loss: 0.0000
Batch [80/149] - Loss: 0.0000
Batch [100/149] - Loss: 0.0000
Batch [120/149] - Loss: 0.0000
Batch [140/149] - Loss: 0.0000

Train Results:
Loss: 0.0340 | Accuracy: 0.9950
Precision: 0.9950 | Recall: 0.9950 | F1: 0.9950
Female (Class 1) - Precision: 0.9906, Recall: 0.9953, F1: 0.9930

Epoch 11 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.5611 | Accuracy: 0.9431
Precision: 0.9432 | Recall: 0.9431 | F1: 0.9417
Female (Class 1) - Precision: 0.9451, Recall: 0.8190, F1: 0.8776

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.94      0.98      0.96       317
      Female       0.95      0.82      0.88       105

    accuracy                           0.94       422
   macro avg       0.94      0.90      0.92       422
weighted avg       0.94      0.94      0.94       422


============================================================
EPOCH 11/25 SUMMARY
Time: 62.32s | LR: 0.000100
Train - Loss: 0.0340, Acc: 0.9950, F1: 0.9950
Val   - Loss: 0.5611, Acc: 0.9431, F1: 0.9417
❌ No improvement. Patience: 3/7
============================================================

Epoch 12 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.0000
Batch [40/149] - Loss: 0.0003
Batch [60/149] - Loss: 0.0000
Batch [80/149] - Loss: 0.0000
Batch [100/149] - Loss: 0.0000
Batch [120/149] - Loss: 0.0000
Batch [140/149] - Loss: 0.0004

Train Results:
Loss: 0.0149 | Accuracy: 0.9979
Precision: 0.9979 | Recall: 0.9979 | F1: 0.9979
Female (Class 1) - Precision: 0.9953, Recall: 0.9988, F1: 0.9971

Epoch 12 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.7366 | Accuracy: 0.9336
Precision: 0.9356 | Recall: 0.9336 | F1: 0.9309
Female (Class 1) - Precision: 0.9639, Recall: 0.7619, F1: 0.8511

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.93      0.99      0.96       317
      Female       0.96      0.76      0.85       105

    accuracy                           0.93       422
   macro avg       0.95      0.88      0.90       422
weighted avg       0.94      0.93      0.93       422


============================================================
EPOCH 12/25 SUMMARY
Time: 65.37s | LR: 0.000050
Train - Loss: 0.0149, Acc: 0.9979, F1: 0.9979
Val   - Loss: 0.7366, Acc: 0.9336, F1: 0.9309
❌ No improvement. Patience: 4/7
============================================================

Epoch 13 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.0000
Batch [40/149] - Loss: 0.0000
Batch [60/149] - Loss: 0.1021
Batch [80/149] - Loss: 0.0000
Batch [100/149] - Loss: 0.0000
Batch [120/149] - Loss: 0.0000
Batch [140/149] - Loss: 0.0000

Train Results:
Loss: 0.0211 | Accuracy: 0.9966
Precision: 0.9966 | Recall: 0.9966 | F1: 0.9966
Female (Class 1) - Precision: 0.9941, Recall: 0.9965, F1: 0.9953

Epoch 13 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.8523 | Accuracy: 0.9360
Precision: 0.9387 | Recall: 0.9360 | F1: 0.9332
Female (Class 1) - Precision: 0.9756, Recall: 0.7619, F1: 0.8556

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.93      0.99      0.96       317
      Female       0.98      0.76      0.86       105

    accuracy                           0.94       422
   macro avg       0.95      0.88      0.91       422
weighted avg       0.94      0.94      0.93       422


============================================================
EPOCH 13/25 SUMMARY
Time: 61.76s | LR: 0.000050
Train - Loss: 0.0211, Acc: 0.9966, F1: 0.9966
Val   - Loss: 0.8523, Acc: 0.9360, F1: 0.9332
❌ No improvement. Patience: 5/7
============================================================

Epoch 14 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.0104
Batch [40/149] - Loss: 0.0000
Batch [60/149] - Loss: 0.0000
Batch [80/149] - Loss: 0.0000
Batch [100/149] - Loss: 0.0001
Batch [120/149] - Loss: 0.0000
Batch [140/149] - Loss: 0.0000

Train Results:
Loss: 0.0163 | Accuracy: 0.9979
Precision: 0.9979 | Recall: 0.9979 | F1: 0.9979
Female (Class 1) - Precision: 0.9976, Recall: 0.9965, F1: 0.9971

Epoch 14 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.5938 | Accuracy: 0.9431
Precision: 0.9432 | Recall: 0.9431 | F1: 0.9417
Female (Class 1) - Precision: 0.9451, Recall: 0.8190, F1: 0.8776

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.94      0.98      0.96       317
      Female       0.95      0.82      0.88       105

    accuracy                           0.94       422
   macro avg       0.94      0.90      0.92       422
weighted avg       0.94      0.94      0.94       422


============================================================
EPOCH 14/25 SUMMARY
Time: 62.13s | LR: 0.000050
Train - Loss: 0.0163, Acc: 0.9979, F1: 0.9979
Val   - Loss: 0.5938, Acc: 0.9431, F1: 0.9417
❌ No improvement. Patience: 6/7
============================================================

Epoch 15 - Training:
--------------------------------------------------
Batch [20/149] - Loss: 0.0000
Batch [40/149] - Loss: 0.0000
Batch [60/149] - Loss: 0.0000
Batch [80/149] - Loss: 0.0000
Batch [100/149] - Loss: 0.0000
Batch [120/149] - Loss: 0.0000
Batch [140/149] - Loss: 0.0000

Train Results:
Loss: 0.0054 | Accuracy: 0.9983
Precision: 0.9983 | Recall: 0.9983 | F1: 0.9983
Female (Class 1) - Precision: 0.9965, Recall: 0.9988, F1: 0.9976

Epoch 15 - Validation:
--------------------------------------------------

Validation Results:
Loss: 0.6399 | Accuracy: 0.9431
Precision: 0.9437 | Recall: 0.9431 | F1: 0.9415
Female (Class 1) - Precision: 0.9551, Recall: 0.8095, F1: 0.8763

Detailed Classification Report:
              precision    recall  f1-score   support

        Male       0.94      0.99      0.96       317
      Female       0.96      0.81      0.88       105

    accuracy                           0.94       422
   macro avg       0.95      0.90      0.92       422
weighted avg       0.94      0.94      0.94       422


============================================================
EPOCH 15/25 SUMMARY
Time: 59.24s | LR: 0.000050
Train - Loss: 0.0054, Acc: 0.9983, F1: 0.9983
Val   - Loss: 0.6399, Acc: 0.9431, F1: 0.9415
❌ No improvement. Patience: 7/7
============================================================

🛑 Early stopping triggered after 15 epochs!
Best validation accuracy: 0.9692

============================================================
TRAINING COMPLETED!
Total time: 16.22 minutes
Best validation accuracy: 0.9692
Best model saved at: checkpoints/face_model.pt
============================================================