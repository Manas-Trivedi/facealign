2025-07-01 15:47:26,094 - INFO - === FACE RECOGNITION MODEL TESTING ===
2025-07-01 15:47:26,094 - INFO - Model path: checkpoints/final_model.pth
2025-07-01 15:47:26,094 - INFO - Data directory: data/facecom/Task_B/
2025-07-01 15:47:26,094 - INFO - Output directory: evaluation_results/evaluation_20250701_154654/task_b_results
2025-07-01 15:47:26,094 - INFO - ================================================================================
2025-07-01 15:47:26,094 - INFO - TASK B - FACE RECOGNITION
2025-07-01 15:47:26,094 - INFO - ================================================================================
2025-07-01 15:47:26,094 - INFO - Objective: Assign each face image to a correct person identity
2025-07-01 15:47:26,094 - INFO -            from a known set of individuals.
2025-07-01 15:47:26,094 - INFO - 
2025-07-01 15:47:26,094 - INFO - OFFICIAL EVALUATION METRICS:
2025-07-01 15:47:26,094 - INFO -   ‚Ä¢ Top-1 Accuracy      - Percentage of correctly identified faces
2025-07-01 15:47:26,094 - INFO -   ‚Ä¢ Macro-averaged F1   - F1-Score averaged across all identities
2025-07-01 15:47:26,094 - INFO - ================================================================================
2025-07-01 15:47:26,114 - INFO - Using device: mps
2025-07-01 15:47:26,114 - INFO - Loading model...
2025-07-01 15:47:26,471 - INFO - ‚úÖ Model loaded successfully
2025-07-01 15:47:26,472 - INFO - Loading validation dataset...
2025-07-01 15:47:26,573 - INFO - Gallery size: 422
2025-07-01 15:47:26,573 - INFO - Positive queries available: 3376
2025-07-01 15:47:26,573 - INFO - Negative queries available: 15408
2025-07-01 15:47:26,574 - INFO - === COMPREHENSIVE VALIDATION ===
2025-07-01 15:47:26,574 - INFO - Computing gallery embeddings...
2025-07-01 15:47:28,942 - INFO - Computing embeddings for 422 images in batches of 32
2025-07-01 15:47:30,284 - INFO - Gallery: 422 embeddings computed
2025-07-01 15:47:30,284 - INFO - === EMBEDDING ANALYSIS ===
2025-07-01 15:47:30,286 - INFO - Embedding L2 norms - Mean: 1.0000, Std: 0.0000
2025-07-01 15:47:30,287 - INFO - NaN values: 0, Inf values: 0
2025-07-01 15:47:30,288 - INFO - Embedding values - Min: -0.2425, Max: 0.2425
2025-07-01 15:47:30,288 - INFO - Embedding values - Mean: -0.0020, Std: 0.0625
2025-07-01 15:47:30,294 - INFO - Pairwise similarities - Min: -0.7964, Max: 0.9931
2025-07-01 15:47:30,294 - INFO - Pairwise similarities - Mean: 0.1416, Std: 0.3874
2025-07-01 15:47:30,294 - INFO - ‚úÖ Embedding analysis completed successfully
2025-07-01 15:47:30,295 - INFO - Creating 1000 validation queries...
2025-07-01 15:47:35,665 - INFO - Computing embeddings for 1000 images in batches of 32
2025-07-01 15:47:38,399 - INFO - Queries: 1000 embeddings computed
2025-07-01 15:47:38,399 - INFO - === EMBEDDING ANALYSIS ===
2025-07-01 15:47:38,399 - INFO - Embedding L2 norms - Mean: 1.0000, Std: 0.0000
2025-07-01 15:47:38,400 - INFO - NaN values: 0, Inf values: 0
2025-07-01 15:47:38,400 - INFO - Embedding values - Min: -0.2558, Max: 0.2364
2025-07-01 15:47:38,400 - INFO - Embedding values - Mean: -0.0013, Std: 0.0625
2025-07-01 15:47:38,403 - INFO - Pairwise similarities - Min: -0.8167, Max: 0.9999
2025-07-01 15:47:38,404 - INFO - Pairwise similarities - Mean: 0.0390, Std: 0.3888
2025-07-01 15:47:38,404 - INFO - ‚úÖ Embedding analysis completed successfully
2025-07-01 15:47:38,404 - INFO - Computing similarities between queries and gallery...
2025-07-01 15:47:38,586 - INFO - === SIMILARITY ANALYSIS ===
2025-07-01 15:47:38,586 - INFO - Similarity range: 0.6059 - 1.0000
2025-07-01 15:47:38,587 - INFO - Similarity mean: 0.9445 ¬± 0.0925
2025-07-01 15:47:38,587 - INFO - Positive pairs similarity: 0.9799 ¬± 0.0300
2025-07-01 15:47:38,587 - INFO - Negative pairs similarity: 0.9090 ¬± 0.1170
2025-07-01 15:47:38,587 - INFO - Similarity gap: 0.0710
2025-07-01 15:47:38,587 - INFO - 
================================================================================
2025-07-01 15:47:38,587 - INFO - OFFICIAL TASK B EVALUATION RESULTS
2025-07-01 15:47:38,587 - INFO - ================================================================================
2025-07-01 15:47:38,587 - INFO - üìä THRESHOLD ANALYSIS FOR FACE RECOGNITION:
2025-07-01 15:47:38,587 - INFO - Threshold | Top-1 Acc | Precision | Recall | F1-Score
2025-07-01 15:47:38,587 - INFO - ------------------------------------------------------------
2025-07-01 15:47:38,597 - INFO -    0.950 |   0.6680 |    0.6144 | 0.9020 |   0.7310
2025-07-01 15:47:38,604 - INFO -    0.960 |   0.6840 |    0.6381 | 0.8500 |   0.7290
2025-07-01 15:47:38,611 - INFO -    0.970 |   0.7130 |    0.6878 | 0.7800 |   0.7310
2025-07-01 15:47:38,619 - INFO -    0.975 |   0.7160 |    0.7093 | 0.7320 |   0.7205
2025-07-01 15:47:38,626 - INFO -    0.980 |   0.7230 |    0.7551 | 0.6600 |   0.7044
2025-07-01 15:47:38,634 - INFO -    0.985 |   0.7350 |    0.8291 | 0.5920 |   0.6908
2025-07-01 15:47:38,641 - INFO -    0.990 |   0.7010 |    0.8708 | 0.4720 |   0.6122
2025-07-01 15:47:38,649 - INFO -    0.992 |   0.6950 |    0.8980 | 0.4400 |   0.5906
2025-07-01 15:47:38,656 - INFO -    0.994 |   0.6780 |    0.9450 | 0.3780 |   0.5400
2025-07-01 15:47:38,663 - INFO -    0.995 |   0.6720 |    0.9624 | 0.3580 |   0.5219
2025-07-01 15:47:38,670 - INFO -    0.996 |   0.6550 |    0.9586 | 0.3240 |   0.4843
2025-07-01 15:47:38,677 - INFO -    0.997 |   0.6410 |    0.9796 | 0.2880 |   0.4451
2025-07-01 15:47:38,684 - INFO -    0.998 |   0.6240 |    1.0000 | 0.2480 |   0.3974
2025-07-01 15:47:38,691 - INFO -    0.999 |   0.5990 |    1.0000 | 0.1980 |   0.3306
2025-07-01 15:47:38,698 - INFO -    1.000 |   0.5810 |    1.0000 | 0.1620 |   0.2788
2025-07-01 15:47:38,698 - INFO - 
üèÜ Best threshold: 0.97 with F1: 0.7310
2025-07-01 15:47:38,698 - INFO - 
üìä OFFICIAL TASK B METRICS (Threshold: 0.97):
2025-07-01 15:47:38,698 - INFO -    Top-1 Accuracy:      0.7130 (71.30%)
2025-07-01 15:47:38,698 - INFO -    Macro-averaged F1:   0.7117
2025-07-01 15:47:38,698 - INFO - 
=== DETAILED ANALYSIS (Threshold: 0.97) ===
2025-07-01 15:47:38,699 - INFO - Confusion Matrix:
2025-07-01 15:47:38,699 - INFO -   True Negatives:   323  |  False Positives:  177
2025-07-01 15:47:38,699 - INFO -   False Negatives:  110  |  True Positives:   390
2025-07-01 15:47:38,701 - INFO - Validation split accuracy: 0.7800, F1: 0.8764
2025-07-01 15:47:38,703 - INFO - Train split accuracy: 0.6460, F1: 0.0000
2025-07-01 15:47:38,703 - INFO - 
=== ROC ANALYSIS ===
2025-07-01 15:47:38,704 - INFO - ROC AUC: 0.8145
2025-07-01 15:47:38,731 - INFO - 
üéâ Testing completed in 12.2 seconds
2025-07-01 15:47:38,731 - INFO - üèÜ Best performance: Top-1 Accuracy=0.7130, Macro F1=0.7117
2025-07-01 15:47:38,731 - INFO - üìä ROC AUC: 0.8145
2025-07-01 15:47:38,731 - INFO - üéØ Best threshold: 0.97
2025-07-01 15:47:38,731 - INFO - === SAVING RESULTS ===
2025-07-01 15:47:38,731 - INFO - Threshold analysis saved to: evaluation_results/evaluation_20250701_154654/task_b_results/threshold_analysis.txt
2025-07-01 15:47:39,570 - INFO - Performance plots saved to: evaluation_results/evaluation_20250701_154654/task_b_results/performance_analysis.png
2025-07-01 15:47:39,996 - INFO - Similarity distribution plots saved to: evaluation_results/evaluation_20250701_154654/task_b_results/similarity_distribution.png
2025-07-01 15:47:39,997 - INFO - ‚úÖ All results saved successfully
2025-07-01 15:47:39,997 - INFO - 
üìù Complete log saved to: evaluation_results/evaluation_20250701_154654/task_b_results/test_log_20250701_154726.txt
2025-07-01 15:47:39,997 - INFO - ‚úÖ Testing completed successfully!
